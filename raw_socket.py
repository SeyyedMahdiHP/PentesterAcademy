import socket
import struct
import binascii

# create a ip raw Socket object
raw_socket = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)
# socket.socket(socket.PF_PACKET, socket.SOCK_RAW, socket.htons(0x0800)) # PF_PACKET only in unix system!
# receive packet from interface
incoming_packet = raw_socket.recvfrom(1514)
# extract headers from Frame:
ethernet_header = struct.unpack(incoming_packet[0][0:14])
ip_header = struct.unpack(incoming_packet[0][14:34])
ethernet_header
ip_header
